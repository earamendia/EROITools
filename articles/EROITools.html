<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EROITools">
<title>EROITools • EROITools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="EROITools">
<meta property="og:description" content="EROITools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EROITools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/EROITools.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Aggregating.html">Aggregating EROIs by fossil fuel group</a>
    <a class="dropdown-item" href="../articles/Breakdown.html">Breaking down useful stage EROIs by sector or end-use</a>
    <a class="dropdown-item" href="../articles/Indirect_Energy.html">Adding indirect or other energy requirements</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>EROITools</h1>
            
      
      
      <div class="d-none name"><code>EROITools.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>R</code> package <code>EROITools</code> provides tools to
aggregate Energy Return On Investment (EROI) values previously
calculated using a Physical Supply Use Table (PSUT) framework to
represent the Energy Conversion Chain (see <span class="citation">Heun,
Owen, and Brockway (2018)</span>). Previous to using the
<code>EROITools</code> package, the World Energy Extended Balances
(WEEB) from the International Energy Agency (IEA) can be loaded and
tidied using the <code>IEATools</code> and <code>ECCTools</code>
<code>R</code> packages. The <code>Recca</code> <code>R</code> package
then allows analysts to calculate a wide range of EROIs at the product
and industry levels, and the <code>EROITools</code> package provides
tools aggregate the calculated EROIs by product group. Important
features of the <code>EROITools</code> package include the
following:</p>
<ul>
<li>Aggregations can be performed either at the global or national
level;</li>
<li>Aggregations can be performed at both the primary and final stage of
energy use, but also at the <strong>useful</strong> stage of energy use
providing that final-to-useful efficiencies are provided by the analyst
for each energy product;</li>
<li>At the useful stage, the package also allows analysts to conduct
these aggregations respecting sectoral or end-use breakdowns, so that
the average useful stage EROI of a product group can be calculated for a
given final demand sector (for instance steelmaking) or for a given
end-use category (for instance high temperature heating);</li>
<li>Last, the package allows analysts to add additional energy
requirements (supposing that these are provided by the analyst) that
cannot be quantified using the IEA’s WEEB such as supply chain energy
requirements — see <span class="citation">Brockway et al. (2019)</span>
or <span class="citation">Brand-Correa et al. (2017)</span> for examples
of a quantification of such indirect energy flows.</li>
</ul>
</div>
<div class="section level2">
<h2 id="available-vignettes">Available vignettes<a class="anchor" aria-label="anchor" href="#available-vignettes"></a>
</h2>
<p>The vignettes available for this package detail how to conduct the
following tasks:</p>
<ol style="list-style-type: decimal">
<li>
<a href="Aggregating.html">Aggregating EROIs by fossil fuel
group</a>: Shows how EROIs can be aggregated by fossil fuel group at the
primary, final, and useful energy stages. The product-level EROIs need
to have been calculated and extracted first as described in the
subsequent example section.</li>
<li>
<a href="Breakdown.html">Breaking down useful stage EROIs by sector
or end-use</a>: Shows how to calculate useful stage EROIs while
respecting a breakdown either by final demand sector or end-use
category.</li>
<li>
<a href="Indirect_Energy.html">Adding indirect or other energy
requirements</a>: Shows how indirect or other energy requirements can be
added to the EROI calculations.</li>
</ol>
</div>
<div class="section level2">
<h2 id="example-for-vignettes-the-ab-world">Example for vignettes: the AB world<a class="anchor" aria-label="anchor" href="#example-for-vignettes-the-ab-world"></a>
</h2>
<p>We use the same example than the one used to describe the
<code>ECCTools</code> package: welcome back to the fictitious AB world
(consisting of country A and country B)!</p>
<div class="section level3">
<h3 id="country-a">Country A<a class="anchor" aria-label="anchor" href="#country-a"></a>
</h3>
<p>The Energy Conversion Chain of country A is shown in the figure
below:</p>
<p><img src="figs/Country_A_ECC.png"></p>
</div>
<div class="section level3">
<h3 id="country-b">Country B<a class="anchor" aria-label="anchor" href="#country-b"></a>
</h3>
<p>Next figure shows the Energy Conversion Chain of country B.</p>
<p><img src="figs/Country_B_ECC.png"></p>
</div>
<div class="section level3">
<h3 id="tidy-ab-data">Tidy AB data<a class="anchor" aria-label="anchor" href="#tidy-ab-data"></a>
</h3>
<p>Let’s now have a look to the AB data organised in a
<code>.tidy_iea_df</code> as provided by the <code>ECCTools</code>
package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fix product-level balances within each country</span></span>
<span><span class="fu">ECCTools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ECCTools/man/tidy_AB_data.html" class="external-link">tidy_AB_data</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 102</span></span>
<span><span class="co">#&gt; Columns: 11</span></span>
<span><span class="co">#&gt; $ Country                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "A", "A", "A", "A", "A", "A", "A", "A", "A…</span></span>
<span><span class="co">#&gt; $ Method                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM"…</span></span>
<span><span class="co">#&gt; $ Energy.type            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E…</span></span>
<span><span class="co">#&gt; $ Last.stage             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "F…</span></span>
<span><span class="co">#&gt; $ Year                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,…</span></span>
<span><span class="co">#&gt; $ Ledger.side            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Consumption", "Consumption", "Consumption", "C…</span></span>
<span><span class="co">#&gt; $ Flow.aggregation.point <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Industry", "Industry", "Industry", "Industry",…</span></span>
<span><span class="co">#&gt; $ Flow                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Iron and steel", "Iron and steel", "Iron and s…</span></span>
<span><span class="co">#&gt; $ Product                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Blast furnace gas", "Electricity", "Heat", "Ke…</span></span>
<span><span class="co">#&gt; $ Unit                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "ktoe", "ktoe", "ktoe", "ktoe", "ktoe", "ktoe",…</span></span>
<span><span class="co">#&gt; $ E.dot                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 500, 2920, 50, 1750, 500, 365, 200, 120, 700, 2…</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculation-of-product-level-erois">Calculation of product-level EROIs<a class="anchor" aria-label="anchor" href="#calculation-of-product-level-erois"></a>
</h3>
<div class="section level4">
<h4 id="domestic-technology-assumption">Domestic Technology Assumption<a class="anchor" aria-label="anchor" href="#domestic-technology-assumption"></a>
</h4>
<p>Let us first modify the Energy Conversion Chain to make it compliant
with the Domestic Technology Assumption (see the vignettes of the
<code>ECCTools</code> package for more information — the basic idea is
to avoid taking into consideration imports in the supply mix of a given
country).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Transforming Energy Conversion Chain to Domestic Technology Assumption</span></span>
<span><span class="va">tidy_AB_dta</span> <span class="op">&lt;-</span> <span class="fu">ECCTools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ECCTools/man/tidy_AB_data.html" class="external-link">tidy_AB_data</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">IEATools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IEATools/man/add_psut_matnames.html" class="external-link">add_psut_matnames</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">ECCTools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ECCTools/man/transform_to_dta.html" class="external-link">transform_to_dta</a></span><span class="op">(</span>requirement_matrices_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"U_feed"</span><span class="op">)</span>,</span>
<span>                               select_dta_observations <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 102</span></span>
<span><span class="co">#&gt; Columns: 12</span></span>
<span><span class="co">#&gt; $ Country                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "A", "A", "A", "A", "A", "A", "A", "A", "A…</span></span>
<span><span class="co">#&gt; $ Method                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM"…</span></span>
<span><span class="co">#&gt; $ Energy.type            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E…</span></span>
<span><span class="co">#&gt; $ Last.stage             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "F…</span></span>
<span><span class="co">#&gt; $ Year                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,…</span></span>
<span><span class="co">#&gt; $ Ledger.side            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Consumption", "Consumption", "Consumption", "C…</span></span>
<span><span class="co">#&gt; $ Flow.aggregation.point <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Industry", "Industry", "Industry", "Industry",…</span></span>
<span><span class="co">#&gt; $ Flow                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Iron and steel", "Iron and steel", "Iron and s…</span></span>
<span><span class="co">#&gt; $ Product                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Blast furnace gas", "Electricity", "Heat", "Ke…</span></span>
<span><span class="co">#&gt; $ Unit                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "ktoe", "ktoe", "ktoe", "ktoe", "ktoe", "ktoe",…</span></span>
<span><span class="co">#&gt; $ E.dot                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 500, 2920, 50, 1750, 500, 365, 200, 120, 700, 2…</span></span>
<span><span class="co">#&gt; $ matnames               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y…</span></span></code></pre></div>
<p>Then, we construct the Input-Output matrices needed to conduct the
calculations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculating associated Input-Output matrices</span></span>
<span><span class="va">tidy_io_AB_dta</span> <span class="op">&lt;-</span> <span class="va">tidy_AB_dta</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">IEATools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IEATools/man/prep_psut.html" class="external-link">prep_psut</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">Recca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Recca/man/calc_io_mats.html" class="external-link">calc_io_mats</a></span><span class="op">(</span>method_q_calculation <span class="op">=</span> <span class="st">"sum_R_V_cols"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 2</span></span>
<span><span class="co">#&gt; Columns: 34</span></span>
<span><span class="co">#&gt; $ Country     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "B"</span></span>
<span><span class="co">#&gt; $ Method      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM"</span></span>
<span><span class="co">#&gt; $ Energy.type <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E"</span></span>
<span><span class="co">#&gt; $ Last.stage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final"</span></span>
<span><span class="co">#&gt; $ Year        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018</span></span>
<span><span class="co">#&gt; $ B           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;matrix[1 x 1]&gt;, &lt;&lt;matrix[3 x 3]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Y           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 6]&gt;&gt;, &lt;&lt;matrix[7 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ S_units     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;, &lt;&lt;matrix[9 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ R           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[3 x 3]&gt;&gt;, &lt;&lt;matrix[1 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 7]&gt;&gt;, &lt;&lt;matrix[8 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 7]&gt;&gt;, &lt;&lt;matrix[5 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_EIOU      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[5 x 7]&gt;&gt;, &lt;&lt;matrix[5 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r_EIOU      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 7]&gt;&gt;, &lt;&lt;matrix[8 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ V           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 9]&gt;&gt;, &lt;&lt;matrix[4 x 6]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ y           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 1]&gt;&gt;, &lt;&lt;matrix[7 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ q           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;, &lt;&lt;matrix[7 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ f           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 1]&gt;&gt;, &lt;&lt;matrix[4 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ g           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 1]&gt;&gt;, &lt;&lt;matrix[4 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ h           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[3 x 1]&gt;&gt;, &lt;&lt;matrix[7 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[3 x 1]&gt;&gt;, &lt;matrix[1 x 1]&gt;</span></span>
<span><span class="co">#&gt; $ W           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 7]&gt;&gt;, &lt;&lt;matrix[9 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Z           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 7]&gt;&gt;, &lt;&lt;matrix[8 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ K           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 7]&gt;&gt;, &lt;&lt;matrix[8 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ C           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 7]&gt;&gt;, &lt;&lt;matrix[6 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ D           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 12]&gt;&gt;, &lt;&lt;matrix[4 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ A           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 12]&gt;&gt;, &lt;&lt;matrix[8 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ O           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[3 x 3]&gt;&gt;, &lt;&lt;matrix[1 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_pxp       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 12]&gt;&gt;, &lt;&lt;matrix[9 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_ixp       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 12]&gt;&gt;, &lt;&lt;matrix[4 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Z_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 7]&gt;&gt;, &lt;&lt;matrix[5 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ K_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 7]&gt;&gt;, &lt;&lt;matrix[5 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ A_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 12]&gt;&gt;, &lt;&lt;matrix[5 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_pxp_feed  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 12]&gt;&gt;, &lt;&lt;matrix[9 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_ixp_feed  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 12]&gt;&gt;, &lt;&lt;matrix[4 x 9]&gt;&gt;</span></span></code></pre></div>
<p>Then, we calculate the product-level EROIs in a matrix format.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculating EROI vectors (matrix format)</span></span>
<span><span class="va">tidy_AB_erois_matrices_dta</span> <span class="op">&lt;-</span> <span class="va">tidy_io_AB_dta</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">Recca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Recca/man/calc_E_EIOU.html" class="external-link">calc_E_EIOU</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">Recca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Recca/man/calc_erois.html" class="external-link">calc_erois</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 2</span></span>
<span><span class="co">#&gt; Columns: 40</span></span>
<span><span class="co">#&gt; $ Country       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "B"</span></span>
<span><span class="co">#&gt; $ Method        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM"</span></span>
<span><span class="co">#&gt; $ Energy.type   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E"</span></span>
<span><span class="co">#&gt; $ Last.stage    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final"</span></span>
<span><span class="co">#&gt; $ Year          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018</span></span>
<span><span class="co">#&gt; $ B             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;matrix[1 x 1]&gt;, &lt;&lt;matrix[3 x 3]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Y             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 6]&gt;&gt;, &lt;&lt;matrix[7 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ S_units       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;, &lt;&lt;matrix[9 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ R             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[3 x 3]&gt;&gt;, &lt;&lt;matrix[1 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 7]&gt;&gt;, &lt;&lt;matrix[8 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_feed        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 7]&gt;&gt;, &lt;&lt;matrix[5 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_EIOU        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[5 x 7]&gt;&gt;, &lt;&lt;matrix[5 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r_EIOU        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 7]&gt;&gt;, &lt;&lt;matrix[8 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ V             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 9]&gt;&gt;, &lt;&lt;matrix[4 x 6]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ y             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 1]&gt;&gt;, &lt;&lt;matrix[7 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ q             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;, &lt;&lt;matrix[7 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ f             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 1]&gt;&gt;, &lt;&lt;matrix[4 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ g             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 1]&gt;&gt;, &lt;&lt;matrix[4 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ h             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[3 x 1]&gt;&gt;, &lt;&lt;matrix[7 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[3 x 1]&gt;&gt;, &lt;matrix[1 x 1]&gt;</span></span>
<span><span class="co">#&gt; $ W             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 7]&gt;&gt;, &lt;&lt;matrix[9 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Z             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 7]&gt;&gt;, &lt;&lt;matrix[8 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ K             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 7]&gt;&gt;, &lt;&lt;matrix[8 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ C             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 7]&gt;&gt;, &lt;&lt;matrix[6 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ D             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 12]&gt;&gt;, &lt;&lt;matrix[4 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ A             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 12]&gt;&gt;, &lt;&lt;matrix[8 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ O             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[3 x 3]&gt;&gt;, &lt;&lt;matrix[1 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_pxp         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 12]&gt;&gt;, &lt;&lt;matrix[9 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_ixp         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 12]&gt;&gt;, &lt;&lt;matrix[4 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Z_feed        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 7]&gt;&gt;, &lt;&lt;matrix[5 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ K_feed        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 7]&gt;&gt;, &lt;&lt;matrix[5 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ A_feed        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 12]&gt;&gt;, &lt;&lt;matrix[5 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_pxp_feed    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 12]&gt;&gt;, &lt;&lt;matrix[9 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_ixp_feed    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 12]&gt;&gt;, &lt;&lt;matrix[4 x 9]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ E_EIOU        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[5 x 7]&gt;&gt;, &lt;&lt;matrix[5 x 4]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ e_EIOU        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 1]&gt;&gt;, &lt;&lt;matrix[4 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ eroi_g_p      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;, &lt;&lt;matrix[9 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ eroi_g_i      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 1]&gt;&gt;, &lt;&lt;matrix[4 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ eroi_g_p_feed <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[12 x 1]&gt;&gt;, &lt;&lt;matrix[9 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ eroi_g_i_feed <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 1]&gt;&gt;, &lt;&lt;matrix[4 x 1]&gt;&gt;</span></span></code></pre></div>
<p>Last, we can drop the matrix format and extract the product-level
EROIs in a tidy data frame format.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extracting EROI values to a tidy data frame format</span></span>
<span><span class="va">tidy_AB_erois_dta</span> <span class="op">&lt;-</span> <span class="va">tidy_AB_erois_matrices_dta</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">EROITools</span><span class="fu">::</span><span class="fu"><a href="../reference/extract_tidy_product_erois.html">extract_tidy_product_erois</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Eroi.method <span class="op">=</span> <span class="st">"DTA"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="st">"Eroi.method"</span><span class="op">)</span>, .after <span class="op">=</span> <span class="va">Year</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 36</span></span>
<span><span class="co">#&gt; Columns: 10</span></span>
<span><span class="co">#&gt; $ Country     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A"…</span></span>
<span><span class="co">#&gt; $ Method      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "P…</span></span>
<span><span class="co">#&gt; $ Energy.type <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E"…</span></span>
<span><span class="co">#&gt; $ Last.stage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "Final", "Fin…</span></span>
<span><span class="co">#&gt; $ Year        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018…</span></span>
<span><span class="co">#&gt; $ Eroi.method <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "DTA", "DTA", "DTA", "DTA", "DTA", "DTA", "DTA", "DTA", "D…</span></span>
<span><span class="co">#&gt; $ Type        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Gross", "Gross", "Gross", "Gross", "Gross", "Gross", "Gro…</span></span>
<span><span class="co">#&gt; $ Boundary    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All", "All", "All", "All", "All", "All", "All", "All", "A…</span></span>
<span><span class="co">#&gt; $ Product     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Blast furnace gas", "Coke oven coke", "Coking coal", "Cru…</span></span>
<span><span class="co">#&gt; $ EROI        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5.185227, 7.239824, 91.083095, 33.935281, 26.362358, 19.07…</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="global-market-assumption">Global Market Assumption<a class="anchor" aria-label="anchor" href="#global-market-assumption"></a>
</h4>
<p>Alternatively, we can modify the Energy Conversion Chain to describe
energy flows across countries using a Multi-Regional Physical Supply Use
Table framework (see <span class="citation">Aramendia et al.
(2022)</span>). For the sake of simplicity, we use here the Global
Market Assumption to demonstrate calculations with the multi-regional
framework.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Transforming Energy Conversion Chain to Global Market Assumption</span></span>
<span><span class="va">tidy_AB_data_gma</span> <span class="op">&lt;-</span> <span class="fu">ECCTools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ECCTools/man/tidy_AB_data.html" class="external-link">tidy_AB_data</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">IEATools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IEATools/man/add_psut_matnames.html" class="external-link">add_psut_matnames</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ECCTools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ECCTools/man/transform_to_gma.html" class="external-link">transform_to_gma</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 101</span></span>
<span><span class="co">#&gt; Columns: 12</span></span>
<span><span class="co">#&gt; $ Country                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "World", "World", "World", "World", "World", "W…</span></span>
<span><span class="co">#&gt; $ Method                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM"…</span></span>
<span><span class="co">#&gt; $ Energy.type            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E…</span></span>
<span><span class="co">#&gt; $ Last.stage             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "F…</span></span>
<span><span class="co">#&gt; $ Year                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,…</span></span>
<span><span class="co">#&gt; $ Ledger.side            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Supply", "Supply", "Supply", "Supply", "Supply…</span></span>
<span><span class="co">#&gt; $ Flow.aggregation.point <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Total primary energy supply", "Total primary e…</span></span>
<span><span class="co">#&gt; $ Flow                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "{A}_Resources [of Coking coal]", "{A}_Resource…</span></span>
<span><span class="co">#&gt; $ Product                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "{A}_Coking coal [from Resources]", "{A}_Crude …</span></span>
<span><span class="co">#&gt; $ Unit                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "ktoe", "ktoe", "ktoe", "ktoe", "ktoe", "ktoe",…</span></span>
<span><span class="co">#&gt; $ E.dot                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5000, 8500, 4000, 600, 2000, 3000, 2500, 850, 5…</span></span>
<span><span class="co">#&gt; $ matnames               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "R", "R", "R", "R", "R", "R", "R", "V", "V", "V…</span></span></code></pre></div>
<p>Then, we construct the Input-Output matrices needed to conduct the
calculations.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculating associated Input-Output matrices</span></span>
<span><span class="va">tidy_io_AB_gma</span> <span class="op">&lt;-</span> <span class="va">tidy_AB_data_gma</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">IEATools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IEATools/man/prep_psut.html" class="external-link">prep_psut</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">Recca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Recca/man/calc_io_mats.html" class="external-link">calc_io_mats</a></span><span class="op">(</span>method_q_calculation <span class="op">=</span> <span class="st">"sum_R_V_cols"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 33</span></span>
<span><span class="co">#&gt; $ Country     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "World"</span></span>
<span><span class="co">#&gt; $ Method      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM"</span></span>
<span><span class="co">#&gt; $ Energy.type <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"</span></span>
<span><span class="co">#&gt; $ Last.stage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"</span></span>
<span><span class="co">#&gt; $ Year        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018</span></span>
<span><span class="co">#&gt; $ Y           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[13 x 6]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ S_units     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ R           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[16 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_EIOU      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r_EIOU      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[16 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ V           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 15]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ y           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[13 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ q           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ f           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ g           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ h           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ W           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[18 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Z           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[16 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ K           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[16 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ C           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[15 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ D           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ A           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[16 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ O           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_pxp       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_ixp       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Z_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ K_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ A_feed      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_pxp_feed  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_ixp_feed  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 21]&gt;&gt;</span></span></code></pre></div>
<p>Then, we calculate the product-level EROIs in a matric format.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculating EROI vectors (matrix format)</span></span>
<span><span class="va">tidy_AB_erois_matrices_gma</span> <span class="op">&lt;-</span> <span class="va">tidy_io_AB_gma</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">Recca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Recca/man/calc_E_EIOU.html" class="external-link">calc_E_EIOU</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">Recca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Recca/man/calc_erois.html" class="external-link">calc_erois</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 39</span></span>
<span><span class="co">#&gt; $ Country       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "World"</span></span>
<span><span class="co">#&gt; $ Method        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM"</span></span>
<span><span class="co">#&gt; $ Energy.type   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E"</span></span>
<span><span class="co">#&gt; $ Last.stage    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final"</span></span>
<span><span class="co">#&gt; $ Year          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018</span></span>
<span><span class="co">#&gt; $ Y             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[13 x 6]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ S_units       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ R             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[16 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_feed        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ U_EIOU        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r_EIOU        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[16 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ V             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 15]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ y             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[13 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ q             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ f             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ g             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ h             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ r             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ W             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[18 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Z             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[16 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ K             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[16 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ C             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[15 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ D             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ A             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[16 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ O             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[7 x 7]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_pxp         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_ixp         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ Z_feed        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ K_feed        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ A_feed        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_pxp_feed    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ L_ixp_feed    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 21]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ E_EIOU        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[9 x 11]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ e_EIOU        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ eroi_g_p      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ eroi_g_i      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ eroi_g_p_feed <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[21 x 1]&gt;&gt;</span></span>
<span><span class="co">#&gt; $ eroi_g_i_feed <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;&lt;matrix[11 x 1]&gt;&gt;</span></span></code></pre></div>
<p>Last, we can drop the matrix format and extract the product-level
EROIs in a tidy data frame format.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extracting EROI values to a tidy data frame format</span></span>
<span><span class="va">tidy_AB_erois_gma</span> <span class="op">&lt;-</span> <span class="va">tidy_AB_erois_matrices_gma</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">EROITools</span><span class="fu">::</span><span class="fu"><a href="../reference/extract_tidy_product_erois.html">extract_tidy_product_erois</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Eroi.method <span class="op">=</span> <span class="st">"GMA"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="st">"Eroi.method"</span><span class="op">)</span>, .after <span class="op">=</span> <span class="va">Year</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 36</span></span>
<span><span class="co">#&gt; Columns: 10</span></span>
<span><span class="co">#&gt; $ Country     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "World", "World", "World", "World", "World", "World", "Wor…</span></span>
<span><span class="co">#&gt; $ Method      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "P…</span></span>
<span><span class="co">#&gt; $ Energy.type <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E"…</span></span>
<span><span class="co">#&gt; $ Last.stage  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "Final", "Fin…</span></span>
<span><span class="co">#&gt; $ Year        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018…</span></span>
<span><span class="co">#&gt; $ Eroi.method <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GMA", "GMA", "GMA", "GMA", "GMA", "GMA", "GMA", "GMA", "G…</span></span>
<span><span class="co">#&gt; $ Type        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Gross", "Gross", "Gross", "Gross", "Gross", "Gross", "Gro…</span></span>
<span><span class="co">#&gt; $ Boundary    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All", "All", "All", "All", "All", "All", "All", "All", "A…</span></span>
<span><span class="co">#&gt; $ Product     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "{A}_Blast furnace gas", "{A}_Coke oven coke", "{A}_Coking…</span></span>
<span><span class="co">#&gt; $ EROI        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3.231508, 16.660572, 89.065580, 33.838980, 24.019478, 18.0…</span></span></code></pre></div>
<p>It can be seen that in the Global Market Assumption, there is only
one region (“World”), and that the EROI of each product is specified in
function of the region of <strong>production</strong> (not consumption!)
of the product — information contained in the product name (“Product”
column).</p>
<p>The rest of the vignettes will demonstrate the <code>EROITools</code>
package based on the <code>tidy_AB_erois_dta</code> and
<code>tidy_AB_erois_gma</code> data frames.</p>
</div>
</div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-mr_psut_paper" class="csl-entry">
Aramendia, Emmanuel, Matthew Heun, Paul Brockway, and Peter Taylor.
2022. <span>“Developing a Multi-Regional Physical Supply Use Table
Framework to Improve the Accuracy and Reliability of Energy
Analysis.”</span> <em>Applied Energy</em>. <a href="https://doi.org/10.1016/j.apenergy.2021.118413" class="external-link">https://doi.org/10.1016/j.apenergy.2021.118413</a>.
</div>
<div id="ref-brandcorreaDevelopingInputOutputBased2017" class="csl-entry">
Brand-Correa, Lina, Paul Brockway, Claire Copeland, Timothy Foxon, Anne
Owen, and Peter Taylor. 2017. <span>“Developing an <span>Input-Output
Based Method</span> to <span>Estimate</span> a <span>National-Level
Energy Return</span> on <span>Investment</span>
(<span>EROI</span>).”</span> <em>Energies</em> 10 (4): 534. <a href="https://doi.org/10.3390/en10040534" class="external-link">https://doi.org/10.3390/en10040534</a>.
</div>
<div id="ref-brockwayEstimationGlobalFinalstage2019" class="csl-entry">
Brockway, Paul E., Anne Owen, Lina I. Brand-Correa, and Lukas Hardt.
2019. <span>“Estimation of Global Final-Stage
Energy-Return-on-Investment for Fossil Fuels with Comparison to
Renewable Energy Sources.”</span> <em>Nature Energy</em> 4 (7): 612–21.
<a href="https://doi.org/10.1038/s41560-019-0425-z" class="external-link">https://doi.org/10.1038/s41560-019-0425-z</a>.
</div>
<div id="ref-Heun:2018" class="csl-entry">
Heun, Matthew Kuperus, Anne Owen, and Paul E. Brockway. 2018. <span>“A
Physical Supply-Use Table Framework for Energy Analysis on the Energy
Conversion Chain.”</span> <em>Applied Energy</em> 226 (September):
1134–62. <a href="https://doi.org/10.1016/j.apenergy.2018.05.109" class="external-link">https://doi.org/10.1016/j.apenergy.2018.05.109</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
