<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EROITools">
<title>Adding indirect or other energy requirements • EROITools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adding indirect or other energy requirements">
<meta property="og:description" content="EROITools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EROITools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/EROITools.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Aggregating.html">Aggregating EROIs by fossil fuel group</a>
    <a class="dropdown-item" href="../articles/Breakdown.html">Breaking down useful stage EROIs by sector or end-use</a>
    <a class="dropdown-item" href="../articles/Indirect_Energy.html">Adding indirect or other energy requirements</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Adding indirect or other energy requirements</h1>
            
      
      
      <div class="d-none name"><code>Indirect_Energy.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we show how indirect energy requirements (or other
energy requirements) can be added to the energy requirements of a given
EROI. Note that the analyst would have to provide the indirect energy
requirements (or other energy requirements) to use the functions
provided in the <code>EROITools</code> package.</p>
<div class="section level2">
<h2 id="adding-indirect-energy-requirements">Adding indirect energy requirements<a class="anchor" aria-label="anchor" href="#adding-indirect-energy-requirements"></a>
</h2>
<p>We start by expanding the product-level EROIs to the useful stage
using some made-up final-to-useful efficiencies for each product, in a
similar vein to what has been done in the other vignettes.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Constructing final-to-useful efficiencies data frame</span></span>
<span><span class="co"># Pushing to tidy useful stage EROIs:</span></span>
<span><span class="va">length_to_use</span> <span class="op">&lt;-</span> <span class="va">tidy_AB_erois_dta</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Country</span>, <span class="va">Method</span>, <span class="va">Energy.type</span>, <span class="va">Year</span>, <span class="va">Product</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tidy_FU_efficiencies_dta</span> <span class="op">&lt;-</span> <span class="va">tidy_AB_erois_dta</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Country</span>, <span class="va">Method</span>, <span class="va">Energy.type</span>, <span class="va">Year</span>, <span class="va">Product</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Average_Efficiency_Col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">1</span>, <span class="fl">0.85</span><span class="op">/</span><span class="op">(</span><span class="va">length_to_use</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">tidy_useful_erois_dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/push_to_useful_erois.html">push_to_useful_erois</a></span><span class="op">(</span></span>
<span>    .tidy_io_erois <span class="op">=</span> <span class="va">tidy_AB_erois_dta</span>,</span>
<span>    tidy_FU_efficiencies <span class="op">=</span> <span class="va">tidy_FU_efficiencies_dta</span>,</span>
<span>    eroi_calc_method <span class="op">=</span> <span class="st">"dta"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 72</span></span>
<span><span class="co">#&gt; Columns: 12</span></span>
<span><span class="co">#&gt; $ Country                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "A", "A", "A", "A", "A", "A", "A", "A", "A…</span></span>
<span><span class="co">#&gt; $ Method                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM"…</span></span>
<span><span class="co">#&gt; $ Energy.type            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E…</span></span>
<span><span class="co">#&gt; $ Last.stage             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "F…</span></span>
<span><span class="co">#&gt; $ Year                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,…</span></span>
<span><span class="co">#&gt; $ Eroi.method            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "DTA", "DTA", "DTA", "DTA", "DTA", "DTA", "DTA"…</span></span>
<span><span class="co">#&gt; $ Type                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Gross", "Gross", "Gross", "Gross", "Gross", "G…</span></span>
<span><span class="co">#&gt; $ Boundary               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All", "All", "All", "All", "All", "All", "All"…</span></span>
<span><span class="co">#&gt; $ Product                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Blast furnace gas", "Coke oven coke", "Coking …</span></span>
<span><span class="co">#&gt; $ EROI                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5.185227, 7.239824, 91.083095, 33.935281, 26.36…</span></span>
<span><span class="co">#&gt; $ Average_Efficiency_Col <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45, 0.50,…</span></span>
<span><span class="co">#&gt; $ Useful_Stage_EROI      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.7777841, 1.4479647, 22.7707738, 10.1805843, 9…</span></span></code></pre></div>
<p>Then, we aggregate primary, final, and useful stage EROIs using the
functions of the package, and bind all the results in a single data
frame of aggregated EROIs.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Primary stage EROIs:</span></span>
<span><span class="va">primary_erois</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_primary_stage_erois.html">aggregate_primary_stage_erois</a></span><span class="op">(</span></span>
<span>  .tidy_erois_df <span class="op">=</span> <span class="va">tidy_AB_erois_dta</span>,</span>
<span>  .tidy_iea_df <span class="op">=</span> <span class="va">tidy_AB_dta</span>,</span>
<span>  eroi_calc_method <span class="op">=</span> <span class="st">"dta"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Final stage EROIs:</span></span>
<span><span class="va">final_erois</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_final_stage_erois.html">aggregate_final_stage_erois</a></span><span class="op">(</span></span>
<span>  .tidy_erois_df <span class="op">=</span> <span class="va">tidy_AB_erois_dta</span>,</span>
<span>  .tidy_iea_df <span class="op">=</span> <span class="va">tidy_AB_dta</span>,</span>
<span>  eroi_calc_method <span class="op">=</span> <span class="st">"dta"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Useful stage EROIs:</span></span>
<span><span class="va">useful_erois</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_useful_stage_erois.html">aggregate_useful_stage_erois</a></span><span class="op">(</span></span>
<span>  .tidy_erois_df <span class="op">=</span> <span class="va">tidy_useful_erois_dta</span>,</span>
<span>  .tidy_iea_df <span class="op">=</span> <span class="va">tidy_AB_dta</span>,</span>
<span>  eroi_calc_method <span class="op">=</span> <span class="st">"dta"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># All EROIs in single data frame:</span></span>
<span><span class="va">all_aggregated_erois</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">primary_erois</span>,</span>
<span>  <span class="va">final_erois</span>,</span>
<span>  <span class="va">useful_erois</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next, the analyst needs to provide a data frame containing for each
product, year, product group, and energy stage (primary, final), the
indirect energy requirements quantified in the same unit that the
<code>.tidy_iea_df</code> being used (here the <code>tidy_AB_dta</code>
data frame). Here, we make up our own data to demonstrate the package
and the structure of the input data frame that the analyst needs to
provide.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prepare_nrows_df</span> <span class="op">&lt;-</span> <span class="va">all_aggregated_erois</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Energy.stage</span> <span class="op">==</span> <span class="st">"Primary"</span> <span class="op">|</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">Energy.stage</span>, <span class="st">"Final"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Energy.stage <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">Energy.stage</span>, <span class="st">"Final"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Final"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">Energy.stage</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Country</span>, <span class="va">Year</span>, <span class="va">Product.Group</span>, <span class="va">Energy.stage</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Indirect_Energy <span class="op">=</span> <span class="st">"Included"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 13</span></span>
<span><span class="co">#&gt; Columns: 5</span></span>
<span><span class="co">#&gt; $ Country         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "A", "A", "A", "A", "A", "A", "A", "B", "B", "B",…</span></span>
<span><span class="co">#&gt; $ Year            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, …</span></span>
<span><span class="co">#&gt; $ Product.Group   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All fossil fuels", "Coal products", "Oil and gas prod…</span></span>
<span><span class="co">#&gt; $ Energy.stage    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Primary", "Primary", "Primary", "Final", "Final", "Fi…</span></span>
<span><span class="co">#&gt; $ Indirect_Energy <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Included", "Included", "Included", "Included", "Inclu…</span></span>
<span></span>
<span><span class="va">n_rows</span> <span class="op">&lt;-</span> <span class="va">prepare_nrows_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">idE_df</span> <span class="op">&lt;-</span> <span class="va">prepare_nrows_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Indirect_Energy_ktoe <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span>, <span class="fl">1000</span><span class="op">/</span><span class="op">(</span><span class="va">n_rows</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 13</span></span>
<span><span class="co">#&gt; Columns: 6</span></span>
<span><span class="co">#&gt; $ Country              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "A", "A", "A", "A", "A", "A", "A", "B", "B",…</span></span>
<span><span class="co">#&gt; $ Year                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2…</span></span>
<span><span class="co">#&gt; $ Product.Group        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All fossil fuels", "Coal products", "Oil and gas…</span></span>
<span><span class="co">#&gt; $ Energy.stage         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Primary", "Primary", "Primary", "Final", "Final"…</span></span>
<span><span class="co">#&gt; $ Indirect_Energy      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Included", "Included", "Included", "Included", "…</span></span>
<span><span class="co">#&gt; $ Indirect_Energy_ktoe <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00000, 83.33333, 166.66667, 250.00000, 333.3333…</span></span></code></pre></div>
<p>From there, the indirect energy requirements can easily be added to
the energy requirements of each product group using the
<code>add_indirect_energy_to_erois</code> function. Note, the
<code>add_indirect_energy_to_erois</code> adds indirect energy
requirements by calculating, for each product group, the ratio of
indirect energy requirements to energy output, as:</p>
<p><span class="math display">\[r =
\frac{\textrm{idE}}{e_{\textrm{out}}},\]</span></p>
<p>the indirect energy requirements are thus those provided by the
analyst, the energy output by product group is however calculated
internally by the function using the data of the
<code>.tidy_iea_df</code> passed as argument. An important note is that
the analyst can decide to quantify energy products used as non-energy
products as part of the energy output (leading to a lower ratio), or to
exclude them (leading to a higher ratio), using the
<em>include_non_energy_uses</em> argument — this decision has to be made
on the basis of whether energy use should be ascribed to energy products
used as non-energy products or not. By default, it is recommended to
include non-energy uses as part of the output to ensure consistency with
the Physical Supply Use Table calculations, and hence to use TRUE as
value.</p>
<p>The inverse of the new EROI including indirect energy requirements is
then calculated as:</p>
<p><span class="math display">\[\textrm{EROI}_{\textrm{idE}}^{-1} =
\textrm{EROI}_{\textrm{dE}}^{-1} +
\frac{\textrm{idE}}{e_{\textrm{out}}},\]</span></p>
<p>and taking the inverse yields the EROI including indirect energy
requirements.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">erois_with_idE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_indirect_energy_to_erois.html">add_indirect_energy_to_erois</a></span><span class="op">(</span></span>
<span>  .tidy_summarised_erois_df <span class="op">=</span> <span class="va">all_aggregated_erois</span>,</span>
<span>  .tidy_indirect_energy <span class="op">=</span> <span class="va">idE_df</span>,</span>
<span>  .tidy_iea_df <span class="op">=</span> <span class="va">tidy_AB_dta</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 504</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; $ Country         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A",…</span></span>
<span><span class="co">#&gt; $ Method          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM"…</span></span>
<span><span class="co">#&gt; $ Energy.type     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",…</span></span>
<span><span class="co">#&gt; $ Last.stage      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "Final", …</span></span>
<span><span class="co">#&gt; $ Year            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, …</span></span>
<span><span class="co">#&gt; $ Eroi.method     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "DTA", "DTA", "DTA", "DTA", "DTA", "DTA", "DTA", "DTA"…</span></span>
<span><span class="co">#&gt; $ Type            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Gross", "Gross", "Gross", "Gross", "Gross", "Gross", …</span></span>
<span><span class="co">#&gt; $ Boundary        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All", "All", "All", "All", "All", "All", "Feedstock",…</span></span>
<span><span class="co">#&gt; $ Product.Group   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All fossil fuels", "All fossil fuels", "Coal products…</span></span>
<span><span class="co">#&gt; $ Energy.stage    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Primary", "Primary", "Primary", "Primary", "Primary",…</span></span>
<span><span class="co">#&gt; $ Group.eroi      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 40.526689, 40.526689, 36.172053, 91.083095, 23.074664,…</span></span>
<span><span class="co">#&gt; $ Non_Energy_Uses <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></span>
<span><span class="co">#&gt; $ Indirect_Energy <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Included", "Excluded", "Included", "Excluded", "Inclu…</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adding-a-sectoral-or-end-use-breakdown-at-the-useful-stage">Adding a sectoral or end-use breakdown at the useful stage<a class="anchor" aria-label="anchor" href="#adding-a-sectoral-or-end-use-breakdown-at-the-useful-stage"></a>
</h2>
<p>If indirect energy requirements are to be added to EROIs in a way
that respects a given breakdown (by final demand sector, end-use, etc.)
at the useful stage, then one should use instead the
<code>add_indirect_energy_useful_erois_by</code> function.</p>
<p>First, we need to define a data frame containing the useful stage
EROIs for the different categories. For the sake of the example, we
suppose that “Iron and steel” has the highest EROIs, with fuels used in
“Others” having only a EROI of half the value, fuels used in “Road
transportation” only a third, in “Agriculture” only a fourth, and in
“Mining” only a fifth.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_breakdown_categories</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Iron and steel"</span>, <span class="st">"Road transportation"</span>, <span class="st">"Agriculture"</span>, <span class="st">"Mining"</span>, <span class="st">"Others"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Useful stage EROIs:</span></span>
<span><span class="va">useful_stage_erois_by</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_useful_stage_erois.html">aggregate_useful_stage_erois</a></span><span class="op">(</span></span>
<span>  .tidy_erois_df <span class="op">=</span> <span class="va">tidy_useful_erois_dta</span>,</span>
<span>  .tidy_iea_df <span class="op">=</span> <span class="va">tidy_AB_dta</span>,</span>
<span>  eroi_calc_method <span class="op">=</span> <span class="st">"dta"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span></span>
<span>    Categories <span class="op">=</span> <span class="va">list_breakdown_categories</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Group.eroi <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">Categories</span> <span class="op">==</span> <span class="st">"Others"</span> <span class="op">~</span> <span class="va">Group.eroi</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>      <span class="va">Categories</span> <span class="op">==</span> <span class="st">"Road transportation"</span> <span class="op">~</span> <span class="va">Group.eroi</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>      <span class="va">Categories</span> <span class="op">==</span> <span class="st">"Agriculture"</span> <span class="op">~</span> <span class="va">Group.eroi</span><span class="op">/</span><span class="fl">4</span>,</span>
<span>      <span class="va">Categories</span> <span class="op">==</span> <span class="st">"Mining"</span> <span class="op">~</span> <span class="va">Group.eroi</span><span class="op">/</span><span class="fl">5</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">Group.eroi</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 400</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; $ Country         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A",…</span></span>
<span><span class="co">#&gt; $ Method          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM"…</span></span>
<span><span class="co">#&gt; $ Energy.type     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",…</span></span>
<span><span class="co">#&gt; $ Last.stage      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "Final", …</span></span>
<span><span class="co">#&gt; $ Year            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, …</span></span>
<span><span class="co">#&gt; $ Eroi.method     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "DTA", "DTA", "DTA", "DTA", "DTA", "DTA", "DTA", "DTA"…</span></span>
<span><span class="co">#&gt; $ Type            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Gross", "Gross", "Gross", "Gross", "Gross", "Gross", …</span></span>
<span><span class="co">#&gt; $ Boundary        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All", "All", "All", "All", "All", "All", "All", "All"…</span></span>
<span><span class="co">#&gt; $ Non_Energy_Uses <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Excluded", "Excluded", "Excluded", "Excluded", "Exclu…</span></span>
<span><span class="co">#&gt; $ Product.Group   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All fossil fuels", "All fossil fuels", "All fossil fu…</span></span>
<span><span class="co">#&gt; $ Energy.stage    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Useful (fuel)", "Useful (fuel)", "Useful (fuel)", "Us…</span></span>
<span><span class="co">#&gt; $ Group.eroi      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.7410808, 0.9136936, 0.6852702, 0.5482162, 1.3705404,…</span></span>
<span><span class="co">#&gt; $ Categories      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Iron and steel", "Road transportation", "Agriculture"…</span></span></code></pre></div>
<p>We need a data frame containing both EROIs at the final and at the
useful stage:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Final stage EROIs:</span></span>
<span><span class="va">final_erois</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_final_stage_erois.html">aggregate_final_stage_erois</a></span><span class="op">(</span></span>
<span>  .tidy_erois_df <span class="op">=</span> <span class="va">tidy_AB_erois_dta</span>,</span>
<span>  .tidy_iea_df <span class="op">=</span> <span class="va">tidy_AB_dta</span>,</span>
<span>  eroi_calc_method <span class="op">=</span> <span class="st">"dta"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span></span>
<span>    Categories <span class="op">=</span> <span class="va">list_breakdown_categories</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">final_useful_erois</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">useful_stage_erois_by</span>,</span>
<span>  <span class="va">final_erois</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">glimpse</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 800</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; $ Country         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A",…</span></span>
<span><span class="co">#&gt; $ Method          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM"…</span></span>
<span><span class="co">#&gt; $ Energy.type     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E",…</span></span>
<span><span class="co">#&gt; $ Last.stage      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "Final", …</span></span>
<span><span class="co">#&gt; $ Year            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, …</span></span>
<span><span class="co">#&gt; $ Eroi.method     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "DTA", "DTA", "DTA", "DTA", "DTA", "DTA", "DTA", "DTA"…</span></span>
<span><span class="co">#&gt; $ Type            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Gross", "Gross", "Gross", "Gross", "Gross", "Gross", …</span></span>
<span><span class="co">#&gt; $ Boundary        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All", "All", "All", "All", "All", "All", "All", "All"…</span></span>
<span><span class="co">#&gt; $ Non_Energy_Uses <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Excluded", "Excluded", "Excluded", "Excluded", "Exclu…</span></span>
<span><span class="co">#&gt; $ Product.Group   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All fossil fuels", "All fossil fuels", "All fossil fu…</span></span>
<span><span class="co">#&gt; $ Energy.stage    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Useful (fuel)", "Useful (fuel)", "Useful (fuel)", "Us…</span></span>
<span><span class="co">#&gt; $ Group.eroi      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.7410808, 0.9136936, 0.6852702, 0.5482162, 1.3705404,…</span></span>
<span><span class="co">#&gt; $ Categories      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Iron and steel", "Road transportation", "Agriculture"…</span></span></code></pre></div>
<p>Then, we can prepare the values of indirect energy requirements for
each product group:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prepare_idE_df</span> <span class="op">&lt;-</span> <span class="va">final_erois</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">Energy.stage</span>, <span class="st">"Final"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Energy.stage <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">Energy.stage</span>, <span class="st">"Final"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Final"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">Energy.stage</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Country</span>, <span class="va">Year</span>, <span class="va">Product.Group</span>, <span class="va">Energy.stage</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Indirect_Energy <span class="op">=</span> <span class="st">"Included"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n_rows</span> <span class="op">&lt;-</span> <span class="va">prepare_idE_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">idE_by_category_df</span> <span class="op">&lt;-</span> <span class="va">prepare_idE_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Indirect_Energy_ktoe <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span>, <span class="fl">1000</span><span class="op">/</span><span class="op">(</span><span class="va">n_rows</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">glimpse</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 10</span></span>
<span><span class="co">#&gt; Columns: 6</span></span>
<span><span class="co">#&gt; $ Country              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "A", "A", "A", "A", "B", "B", "B", "B", "B"</span></span>
<span><span class="co">#&gt; $ Year                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2…</span></span>
<span><span class="co">#&gt; $ Product.Group        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All fossil fuels", "Coal products", "Natural gas…</span></span>
<span><span class="co">#&gt; $ Energy.stage         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "Fin…</span></span>
<span><span class="co">#&gt; $ Indirect_Energy      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Included", "Included", "Included", "Included", "…</span></span>
<span><span class="co">#&gt; $ Indirect_Energy_ktoe <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000, 111.1111, 222.2222, 333.3333, 444.4444, 5…</span></span></code></pre></div>
<p>and finally, useful stage EROIs including indirect energy
requirements respecting the breakdown by category can be determined
using the <code>add_indirect_energy_useful_erois_by</code> function
as:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_idE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_indirect_energy_useful_erois_by.html">add_indirect_energy_useful_erois_by</a></span><span class="op">(</span></span>
<span>  .tidy_aggregated_erois_by_df <span class="op">=</span> <span class="va">final_useful_erois</span>,</span>
<span>  .tidy_indirect_energy <span class="op">=</span> <span class="va">idE_by_category_df</span>,</span>
<span>  .tidy_iea_df <span class="op">=</span> <span class="va">tidy_AB_dta</span>,</span>
<span>  aggregation_category <span class="op">=</span> <span class="st">"Categories"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">glimpse</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1,200</span></span>
<span><span class="co">#&gt; Columns: 16</span></span>
<span><span class="co">#&gt; $ Country           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A…</span></span>
<span><span class="co">#&gt; $ Method            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PCM", "PC…</span></span>
<span><span class="co">#&gt; $ Energy.type       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "E", "E", "E", "E", "E", "E", "E", "E", "E", "E", "E…</span></span>
<span><span class="co">#&gt; $ Last.stage.x      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", "Final", "Final", "Final", "Final"…</span></span>
<span><span class="co">#&gt; $ Year              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018…</span></span>
<span><span class="co">#&gt; $ Eroi.method       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "DTA", "DTA", "DTA", "DTA", "DTA", "DTA", "DTA", "DT…</span></span>
<span><span class="co">#&gt; $ Type              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Gross", "Gross", "Gross", "Gross", "Gross", "Gross"…</span></span>
<span><span class="co">#&gt; $ Boundary          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All", "All", "All", "All", "All", "All", "All", "Al…</span></span>
<span><span class="co">#&gt; $ Non_Energy_Uses.x <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Excluded", "Excluded", "Excluded", "Excluded", "Exc…</span></span>
<span><span class="co">#&gt; $ Product.Group     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "All fossil fuels", "All fossil fuels", "All fossil …</span></span>
<span><span class="co">#&gt; $ Energy.stage      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Useful (fuel)", "Useful (fuel)", "Useful (fuel)", "…</span></span>
<span><span class="co">#&gt; $ Group.eroi        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.7410808, 1.2271781, 2.7410808, 0.9136936, 0.409059…</span></span>
<span><span class="co">#&gt; $ Categories        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Iron and steel", "Iron and steel", "Iron and steel"…</span></span>
<span><span class="co">#&gt; $ Indirect_Energy   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Included", "Included", "Excluded", "Included", "Inc…</span></span>
<span><span class="co">#&gt; $ Last.stage.y      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Final", "Final", NA, "Final", "Final", NA, "Final",…</span></span>
<span><span class="co">#&gt; $ Non_Energy_Uses.y <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Excluded", "Excluded", NA, "Excluded", "Excluded", …</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
