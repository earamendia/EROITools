<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function calculates the aggregated useful stage EROIs for each fossil fuel group. It determines the shares of uses of each energy product
within each fossil fuel group (by default using the Y and U_eiou matrices), and from these shares determines the average useful stage EROI by fossil fuel group."><title>Aggregates useful stage EROIs by fossil fuel group — aggregate_useful_stage_erois • EROITools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregates useful stage EROIs by fossil fuel group — aggregate_useful_stage_erois"><meta property="og:description" content="The function calculates the aggregated useful stage EROIs for each fossil fuel group. It determines the shares of uses of each energy product
within each fossil fuel group (by default using the Y and U_eiou matrices), and from these shares determines the average useful stage EROI by fossil fuel group."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EROITools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/EROITools.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Aggregating.html">Aggregating EROIs by fossil fuel group</a>
    <a class="dropdown-item" href="../articles/Breakdown.html">Breaking down useful stage EROIs by sector or end-use</a>
    <a class="dropdown-item" href="../articles/Indirect_Energy.html">Adding indirect or other energy requirements</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Aggregates useful stage EROIs by fossil fuel group</h1>
      
      <div class="d-none name"><code>aggregate_useful_stage_erois.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function calculates the aggregated useful stage EROIs for each fossil fuel group. It determines the shares of uses of each energy product
within each fossil fuel group (by default using the Y and U_eiou matrices), and from these shares determines the average useful stage EROI by fossil fuel group.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aggregate_useful_stage_erois</span><span class="op">(</span></span>
<span>  <span class="va">.tidy_erois_df</span>,</span>
<span>  <span class="va">.tidy_iea_df</span>,</span>
<span>  include_non_energy_uses <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  final_use_mats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/IEATools/man/psut_cols.html" class="external-link">psut_cols</a></span><span class="op">$</span><span class="va">Y</span>, <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/IEATools/man/psut_cols.html" class="external-link">psut_cols</a></span><span class="op">$</span><span class="va">U_eiou</span><span class="op">)</span>,</span>
<span>  list_oil_products <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/IEATools/man/oil_and_oil_products.html" class="external-link">oil_and_oil_products</a></span>,</span>
<span>  list_coal_products <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/IEATools/man/coal_and_coal_products.html" class="external-link">coal_and_coal_products</a></span>,</span>
<span>  list_gas_products <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/IEATools/man/primary_gas_products.html" class="external-link">primary_gas_products</a></span>,</span>
<span>  product.group <span class="op">=</span> <span class="st">"Product.Group"</span>,</span>
<span>  country <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/IEATools/man/iea_cols.html" class="external-link">iea_cols</a></span><span class="op">$</span><span class="va">country</span>,</span>
<span>  method <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/IEATools/man/iea_cols.html" class="external-link">iea_cols</a></span><span class="op">$</span><span class="va">method</span>,</span>
<span>  energy_type <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/IEATools/man/iea_cols.html" class="external-link">iea_cols</a></span><span class="op">$</span><span class="va">energy_type</span>,</span>
<span>  last_stage <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/IEATools/man/iea_cols.html" class="external-link">iea_cols</a></span><span class="op">$</span><span class="va">last_stage</span>,</span>
<span>  year <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/IEATools/man/iea_cols.html" class="external-link">iea_cols</a></span><span class="op">$</span><span class="va">year</span>,</span>
<span>  product <span class="op">=</span> <span class="fu">IEATools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/IEATools/man/iea_cols.html" class="external-link">iea_cols</a></span><span class="op">$</span><span class="va">product</span>,</span>
<span>  non_energy_uses <span class="op">=</span> <span class="st">"Non_Energy_Uses"</span>,</span>
<span>  eroi.method <span class="op">=</span> <span class="st">"Eroi.method"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"Type"</span>,</span>
<span>  boundary <span class="op">=</span> <span class="st">"Boundary"</span>,</span>
<span>  share <span class="op">=</span> <span class="st">"Share"</span>,</span>
<span>  useful_stage_eroi <span class="op">=</span> <span class="st">"Useful_Stage_EROI"</span>,</span>
<span>  group.eroi <span class="op">=</span> <span class="st">"Group.eroi"</span>,</span>
<span>  energy.stage <span class="op">=</span> <span class="st">"Energy.stage"</span>,</span>
<span>  product_without_origin <span class="op">=</span> <span class="st">"product_without_origin"</span>,</span>
<span>  Group.eroi.inversed <span class="op">=</span> <span class="st">"Group.eroi.inversed"</span>,</span>
<span>  eroi_calc_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dta"</span>, <span class="st">"gma"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>.tidy_erois_df</dt>
<dd><p>The tidy erois data frame for which the aggregation needs to be done.</p></dd>


<dt>.tidy_iea_df</dt>
<dd><p>The <code>tidy_iea_df</code> from which the input-output erois have been calculated.</p></dd>


<dt>include_non_energy_uses</dt>
<dd><p>A boolean indicating whether the calculation of use shares includes non-energy uses.
Default is FALSE.</p></dd>


<dt>final_use_mats</dt>
<dd><p>The list of matrices to be used for calculating the use shares by energy product.
Default is <code>c(IEATools::psut_cols$Y, IEATools::psut_cols$U_eiou)</code>.</p></dd>


<dt>list_oil_products</dt>
<dd><p>The list of oil products to be used when calculating the use shares.
Default is <code><a href="https://rdrr.io/pkg/IEATools/man/oil_and_oil_products.html" class="external-link">IEATools::oil_and_oil_products</a></code>.</p></dd>


<dt>list_coal_products</dt>
<dd><p>The list of coal products to be used when calculating the use shares.
Default is <code><a href="https://rdrr.io/pkg/IEATools/man/coal_and_coal_products.html" class="external-link">IEATools::coal_and_coal_products</a></code>.</p></dd>


<dt>list_gas_products</dt>
<dd><p>The list of gas products to be used when calculating the use shares.
Default is <code><a href="https://rdrr.io/pkg/IEATools/man/primary_gas_products.html" class="external-link">IEATools::primary_gas_products</a></code>.</p></dd>


<dt>product.group</dt>
<dd><p>The name of the column containing the product group name.
Default is "Product.Group".</p></dd>


<dt>country, method, energy_type, last_stage, year, product</dt>
<dd><p>See <code><a href="https://rdrr.io/pkg/IEATools/man/iea_cols.html" class="external-link">IEATools::iea_cols</a></code>.</p></dd>


<dt>non_energy_uses</dt>
<dd><p>The name of the column stating whether non-energy uses are included in the calculation of use shares.
Default is "Non_Energy_Uses".</p></dd>


<dt>eroi.method</dt>
<dd><p>The name of the column containing the method used for calculating the erois.
Default is "Eroi.method".</p></dd>


<dt>type</dt>
<dd><p>The name of the column containing the type of eroi calculated.
Default is "Type".</p></dd>


<dt>boundary</dt>
<dd><p>The name of the column containing the boundary for the eroi calculation.
Default is "Boundary".</p></dd>


<dt>share</dt>
<dd><p>The name of the column containing the share of each energy product supply within each fossil fuel group.
Default is "Share".</p></dd>


<dt>useful_stage_eroi</dt>
<dd><p>The name of the column containing the useful stage EROIs for each energy product.</p></dd>


<dt>group.eroi</dt>
<dd><p>The name of the column containing the fossil fuel group level eroi value.
Default is "Group.eroi".</p></dd>


<dt>energy.stage</dt>
<dd><p>The name of the column containing the energy stage for the calculation of the EROI.
Default is "Energy.stage".</p></dd>


<dt>product_without_origin</dt>
<dd><p>The name of the column containing the product name excluding the origin of the product.
Default is "product_without_origin".</p></dd>


<dt>Group.eroi.inversed</dt>
<dd><p>Name of the temporary column that computes the inverse of the EROI.</p></dd>


<dt>eroi_calc_method</dt>
<dd><p>The method being used for calculating the erois.
Default is "dta".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A tidy data frame containing the aggregated useful stage EROIs by fossil fuel group.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function can work both on a single country Energy Conversion Chain of Domestic Technology Assumption type,
or with a multi-regional Energy Conversion Chain for instance using the Global Market Assumption. The input data frame
will have to be slightly adapted in this case (for an example see the tests related to the function)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">tidy_AB_dta</span> <span class="op">&lt;-</span> <span class="fu">ECCTools</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ECCTools/man/tidy_AB_data.html" class="external-link">tidy_AB_data</a></span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu">IEATools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IEATools/man/add_psut_matnames.html" class="external-link">add_psut_matnames</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span><span class="fu">ECCTools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ECCTools/man/transform_to_dta.html" class="external-link">transform_to_dta</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Calculating IO matrices</span></span></span>
<span class="r-in"><span><span class="va">tidy_io_AB_dta</span> <span class="op">&lt;-</span> <span class="va">tidy_AB_dta</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">IEATools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IEATools/man/prep_psut.html" class="external-link">prep_psut</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">Recca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Recca/man/calc_io_mats.html" class="external-link">calc_io_mats</a></span><span class="op">(</span>method_q_calculation <span class="op">=</span> <span class="st">"sum_R_V_cols"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Calculating tidy IO EROIs</span></span></span>
<span class="r-in"><span><span class="va">tidy_AB_erois_dta</span> <span class="op">&lt;-</span> <span class="va">tidy_io_AB_dta</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">Recca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Recca/man/calc_E_EIOU.html" class="external-link">calc_E_EIOU</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">Recca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Recca/man/calc_erois.html" class="external-link">calc_erois</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">EROITools</span><span class="fu">::</span><span class="fu"><a href="extract_tidy_product_erois.html">extract_tidy_product_erois</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   Eroi.method <span class="op">=</span> <span class="st">"DTA"</span></span></span>
<span class="r-in"><span> <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="st">"Eroi.method"</span><span class="op">)</span>, .after <span class="op">=</span> <span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Pushing to tidy useful stage EROIs</span></span></span>
<span class="r-in"><span><span class="va">length_to_use</span> <span class="op">&lt;-</span> <span class="va">tidy_AB_erois_dta</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Country</span>, <span class="va">Method</span>, <span class="va">Energy.type</span>, <span class="va">Year</span>, <span class="va">Product</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tidy_FU_efficiencies_dta</span> <span class="op">&lt;-</span> <span class="va">tidy_AB_erois_dta</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Country</span>, <span class="va">Method</span>, <span class="va">Energy.type</span>, <span class="va">Year</span>, <span class="va">Product</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   Average_Efficiency_Global <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">1</span>, <span class="fl">0.85</span><span class="op">/</span><span class="op">(</span><span class="va">length_to_use</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tidy_useful_erois_dta</span> <span class="op">&lt;-</span> <span class="va">tidy_AB_erois_dta</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">tidy_FU_efficiencies_dta</span>,</span></span>
<span class="r-in"><span>                  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Country"</span>, <span class="st">"Method"</span>, <span class="st">"Energy.type"</span>, <span class="st">"Year"</span>, <span class="st">"Product"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   Useful_Stage_EROI <span class="op">=</span> <span class="va">Average_Efficiency_Global</span> <span class="op">*</span> <span class="va">EROI</span></span></span>
<span class="r-in"><span> <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Useful_Stage_EROI</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Calculating aggregated EROIs:</span></span></span>
<span class="r-in"><span><span class="va">res_dta</span> <span class="op">&lt;-</span> <span class="fu">aggregate_useful_stage_erois</span><span class="op">(</span></span></span>
<span class="r-in"><span> .tidy_erois_df <span class="op">=</span> <span class="va">tidy_useful_erois_dta</span>,</span></span>
<span class="r-in"><span> .tidy_iea_df <span class="op">=</span> <span class="va">tidy_AB_dta</span>,</span></span>
<span class="r-in"><span> eroi_calc_method <span class="op">=</span> <span class="st">"dta"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Emmanuel Aramendia.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

